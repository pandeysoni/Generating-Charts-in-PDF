<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<link href='http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js "></script>
	<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
	<script src="https://www.amcharts.com/lib/3/serial.js"></script>
	<script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
	<title>Auto Report</title>
	<style type="text/css">
		#uniqueUsersChart {
			width : 100%;
			height : 450px;
			font-size : 11px;
		}

		.amcharts-main-div-text{
		font-weight: normal !important;
		}
	</style>
</head>

<body>
	<script type="text/javascript">
		var uniqueUsersChart = AmCharts.makeChart("uniqueUsersChart", {
			"addClassNames": true,
			"type": "serial",
			"theme": "light",
			"categoryField": "app",
			"rotate": true,
			"fontFamily": "Lato",
			"categoryAxis": {
				"position": "left",
				"title": "List of Applications",
				"fontSize": 18,
				"color": "#294E79",
				"titleColor": "#294E79",
				 "titleFontSize": 30
			},
			"graphs": [{
				"type": "column",
				"id": "AmGraph-1",
				"lineAlpha": 0,
				"type": "column",
				"valueField": "usersCount",
				"fillColors": ["#9FCFFD", "#136CE5"],
				"fixedColumnWidth": 15,
				"fillAlphas": 0.8,
				"gradientOrientation": "horizontal"
			}],
			"valueAxes": [
				{
					"id": "ValueAxis-1",
					"position": "bottom",
					"gridPosition": "start",
					"title": "Number of Users",
					"fontSize": 18,
					"color": "#294E79",
					"titleColor": "#294E79",
					"titleFontSize": 27,
					"showLastLabel":false,
					"labelFunction": function(value) {
						return numberFormatter(value);
					}
				}
			],
			"dataProvider": [{"app":"Quora","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":16},{"app":"Bcbe learn","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":13},{"app":"Wikipedia","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":10},{"app":"XtraMath","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":2},{"app":"Absolute","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":5},{"app":"iPrism Web filt...","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":5},{"app":"Amazon","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":11},{"app":"YouTube","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":20},{"app":"Lynda","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":4},{"app":"ABCya1","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":6}],
			"startDuration": 0
		})
		var uniqueUsersDataArray = [{"app":"Quora","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":16},{"app":"Bcbe learn","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":13},{"app":"Wikipedia","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":10},{"app":"XtraMath","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":2},{"app":"Absolute","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":5},{"app":"iPrism Web filt...","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":5},{"app":"Amazon","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":11},{"app":"YouTube","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":20},{"app":"Lynda","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":4},{"app":"ABCya1","image":"https://qphs2.fs.quoracdn.net/main-qimg-bba34c5494cd15bbe9ba9c29d47740be.webp","usersCount":6}];
		function numberFormatter(value) {
			// return num > 999 ? (num/1000).toFixed(1) + 'k' : num
			if (value < 1000) {
				return value;   
			}
			
			if (value >= 1000 && value <= 1000000) {
				return  Math.round(value/1000) + 'k';   
			}
			
			if (value >= 1000000 && value <= 1000000000) {
				return Math.round(value/1000000) + 'M';   
			}
			
			if (value >= 1000000000 && value <= 1000000000000) {
				return Math.round(value/1000000000) + 'B';   
			}
			
			else {
				return Math.round(value/1000000000000) + 'T';   
			}
		}
		const uniqueAppLength = uniqueUsersDataArray.filter(d => d.app && d.app.length > 10);
		uniqueUsersChart.categoryAxis.labelOffset = 120
		function modifyAxis(e) {
		
			var axes = e.chart.valueAxes;

			for (i1 in axes) {
			var labels = axes[i1].chart.categoryAxis.allLabels;
				var parent = labels[0].node.parentNode;
				const app_10_Length = uniqueUsersDataArray.filter(d => d.app && d.app.length > 13);
				parent.childNodes[uniqueUsersDataArray.length].childNodes[0].setAttribute("y", "60");
				
				parent.childNodes[uniqueUsersDataArray.length].setAttribute("class", "amcharts-main-div-text");
				for (i2 in labels) {
					var label = labels[i2].node;
					labels[i2].node.setAttribute("text-anchor", "start")
					var group = document.createElementNS('http://www.w3.org/2000/svg', "g");
					var img = document.createElementNS('http://www.w3.org/2000/svg', "image");
					// Setup image
					img.setAttributeNS('http://www.w3.org/1999/xlink', 'href', uniqueUsersDataArray[i2].image);
					img.setAttribute('x', '-50');
					img.setAttribute('y', '-11'); // half the height
					img.setAttribute('width', '40');
					img.setAttribute('height', '40');
					// Swap position to group; remove from label
					group.setAttribute('transform', label.getAttribute('transform'));
					label.setAttribute('transform', '');

					// Group axis labels
					group.appendChild(label);
					group.appendChild(img);
					parent.appendChild(group);
				}
			}
		}
		
		uniqueUsersChart.addListener("drawn", modifyAxis);	
	</script>
		<div id="uniqueUsersChart"></div>				
	</body>

</html>